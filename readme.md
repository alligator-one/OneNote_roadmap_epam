The script HtmlToOne.ps1 is intended to find, parse and write found information into roadmap OneNote file. Compiling information will be sent by email, you can add a list of email addresses on Jenkins job configuration page

The script consist of the following parts:

• Confluence parsing

• Bitbucket parsing

• Jenkins parsing

• Compiling found information into OneNote file

• Sending OneNote file by email

• Removing OneNote file on Jenkins server

The script uses template XML file, you can change this template by using special converter from OneNote file to XML file. The converter is located in getPages.ps1 script.

*How to convert onenote file to xml template*

The script getPages.ps1 converts onenote file to XML file, and changes meta information. When a template xml file is generated by a script, it inserts various meta information. If it is not deleted, then there will be an error, so you need to completely delete all objects, look like  ObjectId="{4CAB9D5F-936E-4E5E-9553-DAE696B33111}{15}{B0}". Besides it is necessary to replace the ObjectId="{4CAB9D5F-936E-4E5E-9553-DAE696B33111}{15}{B0}" to ID={{PAGEID}} (the page identifier). The script add necessary information.

Run OneNote file and open a file with template.

Use tags to add parsed information to the template. 

You can use variable {{release}} – the release number, that is passed as a parameter form Jenkins job. Besides, you can use $release variable with the same information.
 

After adding new tags into the template you need to convert the onenote file to the xml template using getPages.ps1.

Syntax: getPages.ps1 [-one]<path to onenote template> [-template]<path to xml template to be generated>

Example: 

.\getPages.ps1 -one H:\Development\onenote\test\ReleaseTemplate.one -template ./templateRelease.xml

*Confluence parsing*

The script try to found information on the page:

"http://docs/pages/viewpage.action?spaceKey=BC&title="+$release

Where $release is number of release, which can be set on Jenkins Configuration page.

*Jenkins parsing*

You can use tag <span style="display:none"> inside the script to hide unnecessary lines. 

*Bitbucket parisng*

Script try to find path to sql scripts: 

• https://bitbucket/src/$release/Arpplication/ClientData/DbScripts/$release_sql

• https://bitbucket/src/$release/Application/CustomizationManager/DbScripts/$release.sql

• https://bitbucket/src/$release/Application/OrderIntel/DbScripts/$release.sql

• https://bitbucket/src/$release/DbScripts/$release.sql

• https://bitbucket/src/Release$/WebServices/BDA.Commerce.WebServices/DbScripts/$release.sql 

After running parsing and writing all information the script closes the OneNote COM server. If the script is suddenly stopped, the program OneNote on Jenkins Server may be corrupted. In this case, you need to perform a OneNote quick recovery using the control panel on the Jenkins server.

